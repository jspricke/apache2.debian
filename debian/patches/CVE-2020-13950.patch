Description: The proxy connection may be NULL during prefetch, don't try to dereference it!
 Still origin->keepalive will be set according to p_conn->close by the caller
 (proxy_http_handler).
Author: Apache authors
Origin: upstream, https://svn.apache.org/r1678771
Bug: <url in upstream bugtracker>
Forwarded: not-needed
Reviewed-By: Yadd <yadd@debian.org>
Last-Update: 2021-06-10

--- a/modules/proxy/mod_proxy_http.c
+++ b/modules/proxy/mod_proxy_http.c
@@ -577,7 +577,6 @@
     apr_off_t bytes;
     int force10, rv;
     apr_read_type_e block;
-    conn_rec *origin = p_conn->connection;
 
     if (apr_table_get(r->subprocess_env, "force-proxy-request-1.0")) {
         if (req->expecting_100) {
@@ -637,7 +636,6 @@
                       "chunked body with Content-Length (C-L ignored)",
                       c->client_ip, c->remote_host ? c->remote_host: "");
         req->old_cl_val = NULL;
-        origin->keepalive = AP_CONN_CLOSE;
         p_conn->close = 1;
     }
 
